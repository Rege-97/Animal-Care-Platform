<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.animal.api.admin.donation.mapper.AdminDonationMapper">

<select id="getAdminDonationList" parameterType="Map" resultType="com.animal.api.admin.donation.model.response.AdminAllDonationResponseDTO">
SELECT
	D.IDX,
	D.NAME,
	DS.NAME AS status,
	D.COMPLETION_AMOUNT AS completionAmount,
	D.AMOUNT,
	D.COMPLETION_RATE AS completionRate,
	D.START_DATE,
	D.END_DATE
FROM
	DONATIONS D
JOIN DONATION_STATUS DS ON
	D.IDX = DS.IDX
ORDER BY
	D.IDX DESC
limit ${listSize} OFFSET ${cp}
</select>

<select id="searchAdminDonation" parameterType="com.animal.api.admin.donation.model.response.AdminAllDonationResponseDTO" resultType="com.animal.api.admin.donation.model.response.AdminAllDonationResponseDTO">
SELECT
	D.IDX,
	D.NAME,
	DS.NAME AS STATUS,
	D.COMPLETION_AMOUNT,
	D.AMOUNT,
	D.COMPLETION_RATE,
	D.START_DATE,
	D.END_DATE
FROM
	DONATIONS D
JOIN DONATION_STATUS DS ON
	D.IDX = DS.IDX
<where>
	<if test = "name != null and name !=''">
	AND D.NAME LIKE '%${name}%'
	</if>
	<if test = "status != null and status !=''">
	AND DS.NAME = #{status}
	</if>
</where>
ORDER BY
	D.IDX DESC
limit ${listSize} OFFSET ${cp}
</select>


</mapper>